<?php

namespace Oil\Form;

use St\Api;

class TankForm extends \St\Form\Form
{
	/**
     * Form basic elements
     *
     * @var array
     */
	protected $mergeElements = array( 
		'id' => array( 
			'name' => 'id', 
			'type' => 'hidden', 
			'options' => array( 
				'label' => 'Id' 
			), 
			'attributes' => array( 
				'value' => '' 
			) 
		), 

		'oil_no' => array( 
				'name' => 'oil_no',
				'type' => 'select',
				'callback' => 'getOil',
				'options' => array(
						'label' => '油品:',
						'empty_option' => '--請選擇--',
						// 'value_options' => '',
				)
				,
				'attributes' => array(
						//  'value' => 'active'
				)
		), 
		'depot' => array( 
			'name' => 'depot', 
			'type' => 'text', 
			'options' => array( 
				'label' => '油槽:'
			), 
			'attributes' => array( 
				'value' => '' 
			) 
		),
	)
	;
	
	/**
     * Form basic Validators
     *
     * @var array
     */
	protected $mergeFilters = array( 
		'id' => array( 
			'name' => 'id', 
			'required' => false, 
			'filters' => array(), 
			'validators' => array( 
				'notEmpty' => array( 
					'name' => 'NotEmpty', 
					'options' => array() 
				) 
			) 
		), 
		'oil_no' => array( 
			'name' => 'oil_no', 
			'required' => true, 
			'filters' => array( 
				'stripTags' => array( 
					'name' => 'StripTags' 
				), 
				'stringTrim' => array( 
					'name' => 'StringTrim' 
				) 
			), 
			'validators' => array( 
				'notEmpty' => array( 
					'name' => 'NotEmpty', 
					'options' => array() 
				), 
				'stringLength' => array( 
					'name' => 'StringLength', 
					'options' => array( 
						'max' => '128' 
					) 
				) 
			) 
		), 



		'depot' => array( 
			'name' => 'depot', 
			'required' => false, 
			'filters' => array( 
				'stripTags' => array( 
					'name' => 'StripTags' 
				), 
				'stringTrim' => array( 
					'name' => 'StringTrim' 
				), 
				'stringToLower' => array( 
					'name' => 'StringToLower' 
				) 
			), 
			'validators' => array( 
				'stringLength' => array( 
					'name' => 'StringLength', 
					'options' => array( 
						'max' => '320' 
					) 
				) 
			) 
		),
	)
	;
	
	public function getOil($element)
	{
	
		$config=Api::_()->getConfig();
		$temp = array();
		if($config['oil']){
			foreach($config['oil'] as $key => $val){
				$temp[$val] = $val;
			}
		}
		$element['options']['value_options'] = $temp;
		return $element;
	
	}	
}
